{% comment %}Partial: homework widget. Used in dashboard and student_homework pages.{% endcomment %}

<div class="homework-widget">
    <div class="widget-header">
        <h3>–î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</h3>
        <p>–í—Å–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card stat-card-pending"><div class="stat-icon">üïí</div><div><div class="stat-value">{{ not_submitted_list.count }}</div><p class="stat-label">–ù–µ —Å–¥–∞–Ω–æ</p></div></div>
        <div class="stat-card stat-card-review"><div class="stat-icon">üìÑ</div><div><div class="stat-value">{{ in_review_list.count }}</div><p class="stat-label">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</p></div></div>
        <div class="stat-card stat-card-checked"><div class="stat-icon">‚úì</div><div><div class="stat-value">{{ checked_list.count }}</div><p class="stat-label">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ</p></div></div>
    </div>

    <div class="homework-tabs">
        <button class="tab-btn active" data-tab="not_submitted">–ù–µ —Å–¥–∞–Ω–æ ({{ not_submitted_list.count }})</button>
        <button class="tab-btn" data-tab="in_review">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ ({{ in_review_list.count }})</button>
        <button class="tab-btn" data-tab="checked">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ ({{ checked_list.count }})</button>
    </div>

    <div class="homework-list" id="homework-list-container">
        <div id="tab-content-not_submitted" class="tab-pane active">
            {% for hw in not_submitted_list %}
            <div class="homework-card">
                <div class="hw-card-header"><h3>{{ hw.title }}</h3><span class="hw-status-tag tag-pending">–ù–µ —Å–¥–∞–Ω–æ</span></div>
                <p class="hw-meta">{{ hw.subject.name }} ‚Ä¢ {{ hw.teacher.user.get_full_name }}</p>
                <p class="hw-description">{{ hw.description }}</p>
                <div class="hw-footer">
                        <div class="hw-deadline"><i class="far fa-clock"></i> –°—Ä–æ–∫ —Å–¥–∞—á–∏: {{ hw.due_date|date:"d.m.Y" }}</div>
                        <button class="btn-submit open-submission-modal"
                                data-hw-pk="{{ hw.pk }}"
                                data-hw-title="{{ hw.title|escape }}"
                                data-hw-subject="{{ hw.subject.name|escape }}"
                                data-hw-teacher="{{ hw.teacher.user.get_full_name|escape }}"
                                data-hw-description="{{ hw.description|escape }}">
                            –°–¥–∞—Ç—å —Ä–∞–±–æ—Ç—É
                        </button>
                </div>
            </div>
            {% empty %} <p style="text-align:center; padding: 20px; color: var(--text-secondary);">–ù–µ—Ç –∑–∞–¥–∞–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–¥–∞—Ç—å.</p> {% endfor %}
        </div>

        <div id="tab-content-in_review" class="tab-pane">
            {% for submission in in_review_list %}
            <div class="homework-card">
                <div class="hw-card-header"><h3>{{ submission.homework.title }}</h3><span class="hw-status-tag tag-review">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</span></div>
                <p class="hw-meta">{{ submission.homework.subject.name }} ‚Ä¢ {{ submission.homework.teacher.user.get_full_name }}</p>
                <div class="hw-footer">
                    <div class="hw-deadline"><i class="far fa-calendar-check"></i> –°–¥–∞–Ω–æ: {{ submission.submitted_at|date:"d.m.Y" }}</div>
                    <button class="btn-submit btn-submitted" disabled>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</button>
                </div>
            </div>
            {% empty %} <p style="text-align:center; padding: 20px; color: var(--text-secondary);">–ù–µ—Ç —Ä–∞–±–æ—Ç –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ.</p> {% endfor %}
        </div>

        <div id="tab-content-checked" class="tab-pane">
            {% for submission in checked_list %}
            <div class="homework-card">
                 <div class="hw-card-header"><h3>{{ submission.homework.title }}</h3><span class="hw-status-tag tag-checked">–û—Ü–µ–Ω–∫–∞: {{ submission.grade }}</span></div>
                <p class="hw-meta">{{ submission.homework.subject.name }} ‚Ä¢ {{ submission.homework.teacher.user.get_full_name }}</p>
                <p class="hw-description"><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—á–∏—Ç–µ–ª—è:</strong> {{ submission.teacher_comment|default:"-" }}</p>
                <div class="hw-footer">
                    <div class="hw-deadline"><i class="far fa-calendar-check"></i> –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ: {{ submission.checked_at|date:"d.m.Y" }}</div>
                    <button class="btn-submit btn-checked" disabled>–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ</button>
                </div>
            </div>
            {% empty %} <p style="text-align:center; padding: 20px; color: var(--text-secondary);">–ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç.</p> {% endfor %}
        </div>
    </div>
</div>